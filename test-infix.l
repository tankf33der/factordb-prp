(load "infix.l")

(test
   111
   (calculate '("(" 2 "+" "(" 3 "*" 3 ")" ")" "*" 11 "/" 11 "+" 100)) )
(test
   22
   (calculate '(10 + 2 * 6)) )
(test
   212
   (calculate '(100 * 2 + 12)) )
(test
   1400
   (calculate '(100 * "(" 2 + 12 ")")) )
(test
   100
   (calculate '(100 * "(" 2 + 12 ")" "/" 14)) )
(test 
   6
   (calculate '(2 + 2 * 2)) )
(test 
   6
   (calculate '(2 + "(" 2 * 2 ")")) )
(test 
   8
   (calculate '("(" 2 + 2 ")" * 2)) )
(test 
   8
   (calculate '(2 * 2 * 2)) )
(test 
   8
   (calculate '("(" 2 * 2 * 2 ")")) )
(test 
   10
   (calculate '(2 * 3 + 4)) )
(test 
   10
   (calculate '("(" 2 * 3 ")" + 4)) )
(test 
   14
   (calculate '(2 * "(" 3 + 4 ")")) )
(test
   39919001
   (calculate '(1 + 22 "*" 100 + 11 "!")) )
(test
   7
   (calculate '(1 + 2 + 3 * 4 "/" "(" 1 + 2 ")")) )
(test
   288924656222756301645887764647959612702196006160938828474526467510240782126878465150901968625867701101097013344194721198099822113437434608807770610974796193684229737676141144554134983037370084089238866817396338376379251313860334008958420068232476633127070712548934080557168499726434961368086797967803635767271
   (calculate '(7 "\^" 365 + 2 "\^" 366)) )
(test
   123
   (calculate '(123)) )
(test
   24
   (calculate '(6 + "(" 7 - 5 ")" * 9)) )
(test
   24
   (calculate '(6 + "(" "(" 7 - 5 ")" * 9 ")")) )
(test
   24
   (calculate '(6 + 9 * "(" 7 - 5 ")")) )
(test
   24
   (calculate '(6 + "(" 9 * "(" 7 - 5 ")" ")")) )
(test
   24
   (calculate '(6 - "(" 5 - 7 ")" * 9)) )
(test
   24
   (calculate '(6 - "(" "(" 5 - 7 ")" "*" 9 ")")) )
(test
   24
   (calculate '("(" 7 - 5 ")" * 9 + 6)) )
(test
   24
   (calculate '("(" "(" 7 - 5 ")" * 9 ")" + 6)) )
(test
   24
   (calculate '(6 - 9 * "(" 5 - 7")")) )
(test
   24
   (calculate '(6 - "(" 9 * "(" 5 - 7 ")" ")")) )
(test
   24
   (calculate '(9 * "(" 7 - 5 ")" + 6)) )
(test
   24
   (calculate '("(" 9 * "(" 7 - 5 ")" ")" + 6)) )
(msg 'infix-ok)
(bye)
